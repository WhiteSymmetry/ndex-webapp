<!--   debugging
<pre ng-show="message">
    {{message}}
</pre>
-->

<div id="divNetwork" ng-show="networkQuery.errors.length == 0" class='row'>
    <div class='col-md-3'>

        <div id="divNetworkHeadline" class="row">
                <h4><label>{{networkQuery.currentNetwork.name}}</label</h4>
        </div>

        <div class="row">
            <div id="divNetworkStats">
            <span>
                 <label>nodes:</label>
                <!--<span>{{networkQuery.currentSubnetwork.nodeCount}}</span> out of-->
                 <span>{{networkQuery.currentNetwork.nodeCount}}</span>
            </span>
            <span>
                 <label>edges:</label>
                <!--<span>{{networkQuery.currentSubnetwork.edgeCount}}</span> out of-->
                 <span>{{networkQuery.currentNetwork.edgeCount}}</span>
            </span>
            </div>
        </div>
        <div class='row text-success'>{{networkQuery.currentNetwork.visibility}}</div>

        <hr>

        <div class='row' id='provenanceCanvas'>
        </div>
    </div>

    <div class='col-md-9'>

    <div class='row text-center'>
        <h4>Retrieved Subnetwork</h4>
            <span>
                 <label>nodes:</label>
                <span>{{networkQuery.currentSubnetwork.nodeCount}}</span>
            </span>
            <span>
                 <label>edges:</label>
                 <span>{{networkQuery.currentSubnetwork.edgeCount}}</span>
            </span>
    </div>

    <div class="row" id="canvas">
    </div>

    <div class="row">

        <form id="frmSearchNetwork" ng-submit="networkQuery.submitNetworkQuery()" class="form-inline pull-left">
            <div class="form-group">
            <input class="form-control" type="search" ng-model="networkQuery.searchString" placeholder="Network Terms" required />
            </div>
            <div class="form-group">
            <label>Depth:</label>
                </div>
            <div class="form-group">
            <span>
                <select class="form-control" id="" ng-model="networkQuery.searchDepth.value" ng-selected="1"
                    ng-options="searchDepth.value as searchDepth.name for searchDepth in networkQuery.searchDepths"required></select>
            </span>
            </div>

            <button type="submit" class="btn btn-default ">Run Query</button>
        </form>

    </div>

    <!-- begins tabbable section -->
    <div id="divNetworkTabs" class="row">

        <div ng-show="networkQuery.currentSubnetwork.edgeCount == 0">
            <strong>No results found that match your criteria.</strong>
        </div>
        <tabset ng-hide="networkQuery.currentSubnetwork.edgeCount == 0">
            <tab heading="Edges">
                <div id="divEdges">
                    <ul id="ulSubnetwork" ng-repeat="(id, edge) in networkQuery.currentSubnetwork.edges">

                        <li>
                            <strong>{{networkQuery.currentSubnetwork.nodeLabelMap[edge.subjectId]}}</strong>
                            <em>{{networkQuery.currentSubnetwork.terms[edge.predicateId].name}}</em>
                            <strong>{{networkQuery.currentSubnetwork.nodeLabelMap[edge.objectId]}}</strong>
                            <span ng-repeat='citation in edge.citations'>
                            <a ng-href="{{networkQuery.getCitation(citation)}}" target="_blank"><sup>
                            <span class='glyphicon glyphicon-book'></span>
                            </sup></a>
                            </span>

                            <!--<sup rel="tooltip">{{edgeFootnotes[edge]}}
                            </sup>-->

                        </li>
                        <!-- todo: aliases
                        <li class="TermAliases" ng-show="hasAliases">

                            <div>
                                Alias: <a target="_blank" data-bind="termAlias: $root.Network().terms()[$data]"></a>
                            </div>

                            <div>
                                Related: <a target="_blank" data-bind="termAlias: $root.Network().terms()[$data]"></a>
                            </div>

                        </li>-->

                    </ul>
                </div>
            </tab>
            <tab heading="Nodes">
                <div id="divNodes">
                    <ul id="ulSubnetwork" ng-repeat="node in networkQuery.currentSubnetwork.nodes">
                        <li style="cursor:pointer" ng-click="node.showAliases = !node.showAliases">
                            <strong>{{networkQuery.currentSubnetwork.nodeLabelMap[node.id]}}</strong>
                            <span ng-repeat='citation in node.citations'>
                            <a ng-href="{{networkQuery.getCitation(citation)}}" target="_blank"><sup>
                            <span class='glyphicon glyphicon-book'></span>
                            </sup></a>
                            </span>
                        </li>
                        <li style="background : white" ng-show="node.showAliases && (node.aliases.length > 0)">
                            <span>Aliases:</span>
                            <em ng-repeat='(key,alias) in node.aliases'>
                                {{networkQuery.currentSubnetwork.baseTerms[alias].name}}
                                <span ng-show='(node.aliases.length > 1) && (key < node.aliases.length-1)'>,</span>
                            </em>
                        </li>
                    </ul>
                </div>
            </tab>
            <tab heading="Terms">
                <ul>
                    <li class="row">
                        <div class="col-md-3 col-md-offset-3">
                            <strong>Prefix</strong>
                        </div>
                        <div class="col-md-3"><strong>Base Terms</strong></div>
                    </li>
                </ul>
                <ul id="ulSubnetwork" ng-repeat="(index, term) in networkQuery.currentSubnetwork.termLabelMap">
                    <li class="row">
                        <div class="col-md-3 col-md-offset-3">
                        <strong>{{term.prefix}}</strong></div>
                        <div class="col-md-3">{{term.name}}</div>
                    </li>
                </ul>
            </tab>
        </tabset>

    </div>

    </div>

<!-- end tab content -->
</div>

<div class="container-fluid" ng-hide="networkQuery.validRequest.length == 0">
    <div class="row">
        <div class="col-md-6 col-md-offset-2" ng-repeat="message in networkQuery.errors">
            <p><strong>{{message.label}}</strong> {{message.error}}</p>
        </div>
    </div>
</div>


<script type="text/ng-template" id="queryContent.html">
    <div class="modal-body text-center">
        <img src="img/horizontal-loader.gif">
    </div>
    <div class="modal-footer">
        <button class="btn btn-sm btn-default" ng-click="networkQuery.cancel()">Cancel</button>
    </div>
</script>